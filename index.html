<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>ãã†ããŒãªã‚“ã€‚</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
  background: #0a0a1a;
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
}

.particles {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 0;
}

.particle {
  position: absolute;
  border-radius: 50%;
  animation: floatUp linear infinite;
  opacity: 0.6;
}

@keyframes floatUp {
  0% { transform: translateY(100vh) scale(0); opacity: 0; }
  10% { opacity: 0.6; }
  90% { opacity: 0.6; }
  100% { transform: translateY(-10vh) scale(1); opacity: 0; }
}

.screen {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
  position: relative;
  z-index: 1;
}

.screen.active {
  display: flex;
}

#inputScreen {
  background: radial-gradient(ellipse at center, #1a1a3e 0%, #0a0a1a 70%);
}

.input-title {
  font-size: 1.4em;
  margin-bottom: 8px;
  text-align: center;
  color: #aab;
  text-shadow: 0 0 20px rgba(100,100,255,0.3);
}

.input-subtitle {
  font-size: 0.85em;
  color: #667;
  margin-bottom: 25px;
  text-align: center;
}

.char-input-container {
  display: flex;
  gap: 8px;
  margin-bottom: 25px;
}

.char-box {
  width: 48px;
  height: 62px;
  background: rgba(255,255,255,0.05);
  border: 2px solid rgba(255,255,255,0.15);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.6em;
  color: #fff;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.char-box.active {
  border-color: #6c63ff;
  box-shadow: 0 0 20px rgba(108,99,255,0.4), inset 0 0 20px rgba(108,99,255,0.1);
}

.char-box.filled {
  border-color: #4ecdc4;
  background: rgba(78,205,196,0.1);
  box-shadow: 0 0 15px rgba(78,205,196,0.3);
}

.char-box.hint-revealed {
  border-color: #ffd700;
  background: rgba(255,215,0,0.1);
  box-shadow: 0 0 20px rgba(255,215,0,0.3);
}

.char-box.hint-revealed::after {
  content: '';
  position: absolute;
  bottom: 3px;
  width: 24px;
  height: 2px;
  background: #ffd700;
  border-radius: 1px;
}

.keyboard {
  width: 100%;
  max-width: 380px;
  margin-bottom: 15px;
}

.keyboard-row {
  display: flex;
  justify-content: center;
  gap: 4px;
  margin-bottom: 4px;
}

.key {
  min-width: 32px;
  height: 42px;
  background: linear-gradient(145deg, #2a2a4a, #1a1a3a);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 8px;
  color: #ddd;
  font-size: 0.95em;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.15s;
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}

.key:active {
  background: linear-gradient(145deg, #4a4a7a, #3a3a6a);
  transform: scale(0.93);
  box-shadow: 0 0 15px rgba(108,99,255,0.5);
}

.key.special {
  min-width: 50px;
  background: linear-gradient(145deg, #3a2a5a, #2a1a4a);
  font-size: 0.7em;
  color: #aaf;
}

.key.enter-key {
  min-width: 70px;
  background: linear-gradient(145deg, #2a5a3a, #1a4a2a);
  color: #4ecdc4;
  font-weight: bold;
  font-size: 0.8em;
}

#menuScreen {
  background: radial-gradient(ellipse at top, #1a1a3e 0%, #0a0a1a 70%);
}

.menu-header {
  text-align: center;
  margin-bottom: 25px;
}

.menu-title {
  font-size: 2em;
  font-weight: 900;
  background: linear-gradient(135deg, #6c63ff, #4ecdc4, #ff6b9d);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 6px;
  animation: titleGlow 3s ease-in-out infinite;
}

@keyframes titleGlow {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.3); }
}

.menu-subtitle {
  color: #667;
  font-size: 0.85em;
}

.menu-order-notice {
  color: #ff6b9d;
  font-size: 0.75em;
  margin-top: 4px;
}

.hint-bar {
  display: flex;
  gap: 8px;
  margin-bottom: 25px;
  padding: 14px 18px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
}

.hint-char {
  width: 38px;
  height: 48px;
  background: rgba(255,255,255,0.05);
  border: 2px solid rgba(255,255,255,0.1);
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2em;
  color: #555;
  transition: all 0.5s;
}

.hint-char.revealed {
  color: #ffd700;
  border-color: #ffd700;
  background: rgba(255,215,0,0.1);
  box-shadow: 0 0 15px rgba(255,215,0,0.2);
  animation: hintPop 0.5s ease;
}

@keyframes hintPop {
  0% { transform: scale(1); }
  50% { transform: scale(1.3); }
  100% { transform: scale(1); }
}

.games-grid {
  display: flex;
  flex-direction: column;
  gap: 12px;
  width: 100%;
  max-width: 400px;
}

.game-card {
  position: relative;
  padding: 18px;
  border-radius: 16px;
  text-decoration: none;
  color: #fff;
  overflow: hidden;
  transition: all 0.3s;
  border: 1px solid rgba(255,255,255,0.1);
  display: flex;
  align-items: center;
  gap: 14px;
  -webkit-tap-highlight-color: transparent;
}

.game-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  opacity: 0.15;
  transition: opacity 0.3s;
}

.game-card:active:not(.locked) {
  transform: scale(0.97);
}

.game-card.locked {
  opacity: 0.35;
  pointer-events: none;
  filter: grayscale(0.7);
}

.game-card.current-game {
  border: 2px solid rgba(255,255,255,0.4);
  box-shadow: 0 0 25px rgba(108,99,255,0.3);
}

.game-card.current-game::after {
  content: 'â–¶ NEXT';
  position: absolute;
  top: 8px;
  right: 10px;
  font-size: 0.55em;
  padding: 3px 8px;
  background: rgba(108,99,255,0.5);
  border-radius: 10px;
  color: #fff;
  font-weight: 700;
}

.game-card:nth-child(1) { background: linear-gradient(135deg, rgba(255,107,157,0.2), rgba(255,107,157,0.05)); }
.game-card:nth-child(1)::before { background: linear-gradient(135deg, #ff6b9d, #ff2d7a); }
.game-card:nth-child(1) .game-icon { background: linear-gradient(135deg, #ff6b9d, #ff2d7a); }

.game-card:nth-child(2) { background: linear-gradient(135deg, rgba(108,99,255,0.2), rgba(108,99,255,0.05)); }
.game-card:nth-child(2)::before { background: linear-gradient(135deg, #6c63ff, #4834d4); }
.game-card:nth-child(2) .game-icon { background: linear-gradient(135deg, #6c63ff, #4834d4); }

.game-card:nth-child(3) { background: linear-gradient(135deg, rgba(78,205,196,0.2), rgba(78,205,196,0.05)); }
.game-card:nth-child(3)::before { background: linear-gradient(135deg, #4ecdc4, #2cb5ac); }
.game-card:nth-child(3) .game-icon { background: linear-gradient(135deg, #4ecdc4, #2cb5ac); }

.game-card:nth-child(4) { background: linear-gradient(135deg, rgba(255,165,0,0.2), rgba(255,165,0,0.05)); }
.game-card:nth-child(4)::before { background: linear-gradient(135deg, #ffa500, #ff8c00); }
.game-card:nth-child(4) .game-icon { background: linear-gradient(135deg, #ffa500, #ff8c00); }

.game-card:nth-child(5) { background: linear-gradient(135deg, rgba(0,206,255,0.2), rgba(0,206,255,0.05)); }
.game-card:nth-child(5)::before { background: linear-gradient(135deg, #00ceff, #0099cc); }
.game-card:nth-child(5) .game-icon { background: linear-gradient(135deg, #00ceff, #0099cc); }

.game-card:nth-child(6) { background: linear-gradient(135deg, rgba(180,100,255,0.2), rgba(180,100,255,0.05)); }
.game-card:nth-child(6)::before { background: linear-gradient(135deg, #b464ff, #8a2be2); }
.game-card:nth-child(6) .game-icon { background: linear-gradient(135deg, #b464ff, #8a2be2); }

.game-icon {
  width: 50px;
  height: 50px;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5em;
  flex-shrink: 0;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.game-info { flex: 1; }

.game-name {
  font-size: 1em;
  font-weight: 700;
  margin-bottom: 2px;
}

.game-desc {
  font-size: 0.7em;
  color: rgba(255,255,255,0.5);
}

.game-status {
  font-size: 0.65em;
  padding: 4px 10px;
  border-radius: 20px;
  font-weight: 600;
  flex-shrink: 0;
}

.game-status.not-cleared {
  background: rgba(255,255,255,0.1);
  color: #888;
}

.game-status.cleared {
  background: rgba(78,205,196,0.2);
  color: #4ecdc4;
}

.game-status.locked-status {
  background: rgba(255,255,255,0.05);
  color: #444;
}

.back-to-input-btn {
  margin-top: 20px;
  padding: 14px 40px;
  background: linear-gradient(135deg, #6c63ff, #4ecdc4);
  border: none;
  border-radius: 30px;
  color: #fff;
  font-size: 1em;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 4px 20px rgba(108,99,255,0.3);
  -webkit-tap-highlight-color: transparent;
}

.back-to-input-btn:active {
  transform: scale(0.95);
}

/* ===== ENDING SCREEN - è±ªè¯ç‰ˆ ===== */
#endingScreen {
  background: #000;
  text-align: center;
  overflow: hidden;
  position: relative;
}

#endingScreen::before {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: 
    radial-gradient(ellipse at 20% 50%, rgba(108,99,255,0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 50%, rgba(255,107,157,0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 20%, rgba(255,215,0,0.1) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 80%, rgba(78,205,196,0.1) 0%, transparent 50%);
  animation: endingBgShift 6s ease-in-out infinite;
}

@keyframes endingBgShift {
  0%, 100% { opacity: 0.6; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.05); }
}

.ending-fireworks {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 1;
}

.firework {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  animation: fireworkBurst 2s ease-out infinite;
}

@keyframes fireworkBurst {
  0% { transform: scale(0); opacity: 1; box-shadow: 
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor,
    0 0 0 0 currentColor;
  }
  50% { opacity: 1; }
  100% { transform: scale(1); opacity: 0; box-shadow: 
    0 -60px 0 0 currentColor,
    42px -42px 0 0 currentColor,
    60px 0 0 0 currentColor,
    42px 42px 0 0 currentColor,
    0 60px 0 0 currentColor,
    -42px 42px 0 0 currentColor,
    -60px 0 0 0 currentColor,
    -42px -42px 0 0 currentColor;
  }
}

.confetti-container {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

.confetti {
  position: absolute;
  top: -10px;
  width: 10px;
  height: 14px;
  border-radius: 2px;
  animation: confettiFall linear infinite;
}

@keyframes confettiFall {
  0% { transform: translateY(-10px) rotateZ(0deg) rotateX(0deg); opacity: 1; }
  100% { transform: translateY(100vh) rotateZ(720deg) rotateX(360deg); opacity: 0.3; }
}

.ending-content {
  position: relative;
  z-index: 10;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.ending-crown {
  font-size: 4em;
  margin-bottom: 10px;
  animation: crownFloat 2s ease-in-out infinite;
  filter: drop-shadow(0 0 20px rgba(255,215,0,0.6));
}

@keyframes crownFloat {
  0%, 100% { transform: translateY(0) scale(1); }
  50% { transform: translateY(-12px) scale(1.05); }
}

.ending-stars {
  display: flex;
  gap: 8px;
  margin-bottom: 15px;
}

.ending-star {
  font-size: 1.8em;
  animation: starTwinkle 1.5s ease-in-out infinite;
  filter: drop-shadow(0 0 10px rgba(255,215,0,0.5));
}

.ending-star:nth-child(1) { animation-delay: 0s; }
.ending-star:nth-child(2) { animation-delay: 0.2s; }
.ending-star:nth-child(3) { animation-delay: 0.4s; }
.ending-star:nth-child(4) { animation-delay: 0.6s; }
.ending-star:nth-child(5) { animation-delay: 0.8s; }

@keyframes starTwinkle {
  0%, 100% { transform: scale(1) rotate(0deg); opacity: 0.7; }
  50% { transform: scale(1.3) rotate(20deg); opacity: 1; }
}

.ending-title {
  font-size: 2.8em;
  font-weight: 900;
  background: linear-gradient(135deg, #ffd700, #ffaa00, #ffd700, #fff8dc, #ffd700);
  background-size: 200% 200%;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 5px;
  animation: goldShimmer 3s linear infinite;
  text-shadow: none;
  letter-spacing: 4px;
}

@keyframes goldShimmer {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}

.ending-subtitle {
  font-size: 1em;
  color: #ffd700;
  margin-bottom: 25px;
  letter-spacing: 6px;
  text-transform: uppercase;
  opacity: 0.8;
  animation: subtitlePulse 2s ease-in-out infinite;
}

@keyframes subtitlePulse {
  0%, 100% { opacity: 0.6; letter-spacing: 6px; }
  50% { opacity: 1; letter-spacing: 8px; }
}

.ending-divider {
  width: 200px;
  height: 2px;
  background: linear-gradient(90deg, transparent, #ffd700, transparent);
  margin-bottom: 25px;
  position: relative;
}

.ending-divider::before {
  content: 'â—†';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #ffd700;
  font-size: 0.8em;
  background: #000;
  padding: 0 10px;
}

.ending-message {
  color: #ccc;
  font-size: 1.05em;
  margin-bottom: 12px;
  line-height: 2;
  animation: fadeInUp 1s ease 0.5s both;
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.ending-password-reveal {
  display: flex;
  gap: 10px;
  margin-bottom: 30px;
  animation: fadeInUp 1s ease 1s both;
}

.ending-char {
  width: 50px;
  height: 60px;
  background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,215,0,0.05));
  border: 2px solid #ffd700;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5em;
  color: #ffd700;
  box-shadow: 0 0 20px rgba(255,215,0,0.2), inset 0 0 20px rgba(255,215,0,0.05);
  animation: charGlow 2s ease-in-out infinite;
}

.ending-char:nth-child(1) { animation-delay: 0s; }
.ending-char:nth-child(2) { animation-delay: 0.15s; }
.ending-char:nth-child(3) { animation-delay: 0.3s; }
.ending-char:nth-child(4) { animation-delay: 0.45s; }
.ending-char:nth-child(5) { animation-delay: 0.6s; }
.ending-char:nth-child(6) { animation-delay: 0.75s; }

@keyframes charGlow {
  0%, 100% { box-shadow: 0 0 20px rgba(255,215,0,0.2), inset 0 0 20px rgba(255,215,0,0.05); }
  50% { box-shadow: 0 0 35px rgba(255,215,0,0.5), inset 0 0 30px rgba(255,215,0,0.1); }
}

.ending-btn-container {
  animation: fadeInUp 1s ease 1.5s both;
}

.ending-btn {
  position: relative;
  display: inline-block;
  padding: 18px 60px;
  font-size: 1.2em;
  font-weight: 900;
  color: #fff;
  background: linear-gradient(135deg, #ffd700, #ff6b9d, #6c63ff, #4ecdc4);
  background-size: 300% 300%;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  text-decoration: none;
  letter-spacing: 3px;
  box-shadow: 
    0 0 30px rgba(255,215,0,0.4),
    0 0 60px rgba(255,107,157,0.2),
    0 8px 30px rgba(0,0,0,0.3);
  animation: btnRainbow 4s linear infinite, btnPulse 2s ease-in-out infinite;
  transition: transform 0.2s;
  -webkit-tap-highlight-color: transparent;
  overflow: hidden;
}

.ending-btn::before {
  content: '';
  position: absolute;
  top: -2px; left: -2px;
  right: -2px; bottom: -2px;
  background: linear-gradient(135deg, #ffd700, #ff6b9d, #6c63ff, #4ecdc4, #ffd700);
  background-size: 400% 400%;
  border-radius: 52px;
  z-index: -1;
  animation: btnRainbow 4s linear infinite;
  filter: blur(8px);
  opacity: 0.7;
}

.ending-btn::after {
  content: '';
  position: absolute;
  top: 0; left: -100%;
  width: 100%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: btnShine 3s ease-in-out infinite;
}

@keyframes btnRainbow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes btnPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.03); }
}

@keyframes btnShine {
  0% { left: -100%; }
  50%, 100% { left: 100%; }
}

.ending-btn:active {
  transform: scale(0.95) !important;
}

.ending-bottom-text {
  margin-top: 25px;
  color: #555;
  font-size: 0.75em;
  animation: fadeInUp 1s ease 2s both;
}

.restart-btn {
  margin-top: 15px;
  padding: 10px 30px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 30px;
  color: #666;
  font-size: 0.8em;
  font-weight: 600;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  transition: all 0.3s;
  animation: fadeInUp 1s ease 2.2s both;
}

.restart-btn:active {
  transform: scale(0.95);
  background: rgba(255,255,255,0.15);
}

/* ===== sparkle ring around crown ===== */
.sparkle-ring {
  position: absolute;
  width: 120px;
  height: 120px;
  border: 2px solid transparent;
  border-top-color: #ffd700;
  border-right-color: #ff6b9d;
  border-radius: 50%;
  animation: sparkleRingSpin 3s linear infinite;
  opacity: 0.4;
  pointer-events: none;
}

@keyframes sparkleRingSpin {
  from { transform: translate(-50%, -50%) rotate(0deg); }
  to { transform: translate(-50%, -50%) rotate(360deg); }
}

.sparkle-ring.ring2 {
  width: 150px;
  height: 150px;
  border-top-color: #6c63ff;
  border-right-color: #4ecdc4;
  animation-duration: 4s;
  animation-direction: reverse;
  opacity: 0.25;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-8px); }
  40% { transform: translateX(8px); }
  60% { transform: translateX(-5px); }
  80% { transform: translateX(5px); }
}

.shake { animation: shake 0.4s ease; }

.fade-in {
  animation: fadeIn 0.6s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.message {
  position: fixed;
  top: 30px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 28px;
  border-radius: 30px;
  font-size: 0.9em;
  font-weight: 600;
  z-index: 100;
  opacity: 0;
  transition: opacity 0.3s;
  pointer-events: none;
  white-space: nowrap;
}

.message.show { opacity: 1; }

.message.error {
  background: rgba(255,80,80,0.2);
  border: 1px solid rgba(255,80,80,0.4);
  color: #ff5050;
}

.message.success {
  background: rgba(78,205,196,0.2);
  border: 1px solid rgba(78,205,196,0.4);
  color: #4ecdc4;
}

@media (max-height: 700px) {
  .key { height: 36px; font-size: 0.85em; }
  .char-box { width: 42px; height: 54px; font-size: 1.4em; }
  .input-title { font-size: 1.1em; }
  .input-subtitle { margin-bottom: 15px; }
  .keyboard { margin-bottom: 8px; }
  .ending-title { font-size: 2em; }
  .ending-crown { font-size: 3em; }
}

@media (max-width: 350px) {
  .key { min-width: 26px; font-size: 0.8em; }
  .char-box { width: 38px; height: 50px; }
  .char-input-container { gap: 5px; }
}
</style>
</head>
<body>

<div class="particles" id="particles"></div>
<div class="message" id="message"></div>

<div class="screen active" id="inputScreen">
  <div class="input-title">ğŸ”® ç§˜å¯†ã®åˆè¨€è‘‰ã‚’å…¥åŠ›ã›ã‚ˆ</div>
  <div class="input-subtitle">ï¼–æ–‡å­—ã®ã²ã‚‰ãŒãªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>

  <div class="char-input-container" id="charBoxes">
    <div class="char-box active" data-index="0"></div>
    <div class="char-box" data-index="1"></div>
    <div class="char-box" data-index="2"></div>
    <div class="char-box" data-index="3"></div>
    <div class="char-box" data-index="4"></div>
    <div class="char-box" data-index="5"></div>
  </div>

  <div class="keyboard" id="keyboard">
    <div class="keyboard-row">
      <div class="key" data-char="ã‚">ã‚</div>
      <div class="key" data-char="ã„">ã„</div>
      <div class="key" data-char="ã†">ã†</div>
      <div class="key" data-char="ãˆ">ãˆ</div>
      <div class="key" data-char="ãŠ">ãŠ</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ãƒ">ãƒ</div>
      <div class="key" data-char="ã…">ã…</div>
      <div class="key" data-char="ã‡">ã‡</div>
      <div class="key" data-char="ã‰">ã‰</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ã‹">ã‹</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ã‘">ã‘</div>
      <div class="key" data-char="ã“">ã“</div>
      <div class="key" data-char="ãŒ">ãŒ</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ã’">ã’</div>
      <div class="key" data-char="ã”">ã”</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ã•">ã•</div>
      <div class="key" data-char="ã—">ã—</div>
      <div class="key" data-char="ã™">ã™</div>
      <div class="key" data-char="ã›">ã›</div>
      <div class="key" data-char="ã">ã</div>
      <div class="key" data-char="ã–">ã–</div>
      <div class="key" data-char="ã˜">ã˜</div>
      <div class="key" data-char="ãš">ãš</div>
      <div class="key" data-char="ãœ">ãœ</div>
      <div class="key" data-char="ã">ã</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ãŸ">ãŸ</div>
      <div class="key" data-char="ã¡">ã¡</div>
      <div class="key" data-char="ã¤">ã¤</div>
      <div class="key" data-char="ã¦">ã¦</div>
      <div class="key" data-char="ã¨">ã¨</div>
      <div class="key" data-char="ã ">ã </div>
      <div class="key" data-char="ã¢">ã¢</div>
      <div class="key" data-char="ã¥">ã¥</div>
      <div class="key" data-char="ã§">ã§</div>
      <div class="key" data-char="ã©">ã©</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ãª">ãª</div>
      <div class="key" data-char="ã«">ã«</div>
      <div class="key" data-char="ã¬">ã¬</div>
      <div class="key" data-char="ã­">ã­</div>
      <div class="key" data-char="ã®">ã®</div>
      <div class="key" data-char="ã¯">ã¯</div>
      <div class="key" data-char="ã²">ã²</div>
      <div class="key" data-char="ãµ">ãµ</div>
      <div class="key" data-char="ã¸">ã¸</div>
      <div class="key" data-char="ã»">ã»</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ã°">ã°</div>
      <div class="key" data-char="ã³">ã³</div>
      <div class="key" data-char="ã¶">ã¶</div>
      <div class="key" data-char="ã¹">ã¹</div>
      <div class="key" data-char="ã¼">ã¼</div>
      <div class="key" data-char="ã±">ã±</div>
      <div class="key" data-char="ã´">ã´</div>
      <div class="key" data-char="ã·">ã·</div>
      <div class="key" data-char="ãº">ãº</div>
      <div class="key" data-char="ã½">ã½</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ã¾">ã¾</div>
      <div class="key" data-char="ã¿">ã¿</div>
      <div class="key" data-char="ã‚€">ã‚€</div>
      <div class="key" data-char="ã‚">ã‚</div>
      <div class="key" data-char="ã‚‚">ã‚‚</div>
      <div class="key" data-char="ã‚„">ã‚„</div>
      <div class="key" data-char="ã‚†">ã‚†</div>
      <div class="key" data-char="ã‚ˆ">ã‚ˆ</div>
      <div class="key" data-char="ã‚ƒ">ã‚ƒ</div>
      <div class="key" data-char="ã‚…">ã‚…</div>
    </div>
    <div class="keyboard-row">
      <div class="key" data-char="ã‚‰">ã‚‰</div>
      <div class="key" data-char="ã‚Š">ã‚Š</div>
      <div class="key" data-char="ã‚‹">ã‚‹</div>
      <div class="key" data-char="ã‚Œ">ã‚Œ</div>
      <div class="key" data-char="ã‚">ã‚</div>
      <div class="key" data-char="ã‚">ã‚</div>
      <div class="key" data-char="ã‚’">ã‚’</div>
      <div class="key" data-char="ã‚“">ã‚“</div>
      <div class="key" data-char="ã‚‡">ã‚‡</div>
      <div class="key" data-char="ã£">ã£</div>
    </div>
    <div class="keyboard-row">
      <div class="key special" data-action="backspace">âŒ« æˆ»ã™</div>
      <div class="key special" data-action="clear">âœ• å…¨æ¶ˆ</div>
      <div class="key enter-key" data-action="submit">âœ“ æ±ºå®š</div>
    </div>
  </div>
</div>

<div class="screen" id="menuScreen">
  <div class="menu-header fade-in">
    <div class="menu-title">GAME SELECT</div>
    <div class="menu-subtitle">ã‚²ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢ã—ã¦ãƒ’ãƒ³ãƒˆã‚’é›†ã‚ã‚ˆã†</div>
    <div class="menu-order-notice">â€» ä¸Šã‹ã‚‰é †ç•ªã«ã‚¯ãƒªã‚¢ã—ã¦ãã ã•ã„</div>
  </div>

  <div class="hint-bar fade-in" id="hintBar">
    <div class="hint-char" data-hint="0">ï¼Ÿ</div>
    <div class="hint-char" data-hint="1">ï¼Ÿ</div>
    <div class="hint-char" data-hint="2">ï¼Ÿ</div>
    <div class="hint-char" data-hint="3">ï¼Ÿ</div>
    <div class="hint-char" data-hint="4">ï¼Ÿ</div>
    <div class="hint-char" data-hint="5">ï¼Ÿ</div>
  </div>

  <div class="games-grid fade-in" id="gamesGrid">
    <a class="game-card" href="game1.html" data-game="1">
      <div class="game-icon">âš”ï¸</div>
      <div class="game-info">
        <div class="game-name">Game 1 - ç‚ã®è©¦ç·´</div>
        <div class="game-desc">åå°„ç¥çµŒã‚’è©¦ã™ãƒãƒˆãƒ«ã‚²ãƒ¼ãƒ </div>
      </div>
      <span class="game-status" id="status1">æœªã‚¯ãƒªã‚¢</span>
    </a>
    <a class="game-card" href="game2.html" data-game="2">
      <div class="game-icon">ğŸ§©</div>
      <div class="game-info">
        <div class="game-name">Game 2 - çŸ¥æµã®è¿·å®®</div>
        <div class="game-desc">é ­è„³ã‚’é§†ä½¿ã™ã‚‹ãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ </div>
      </div>
      <span class="game-status" id="status2">æœªã‚¯ãƒªã‚¢</span>
    </a>
    <a class="game-card" href="game3.html" data-game="3">
      <div class="game-icon">ğŸµ</div>
      <div class="game-info">
        <div class="game-name">Game 3 - éŸ³ã®ãƒªã‚ºãƒ </div>
        <div class="game-desc">ãƒªã‚ºãƒ ã«åˆã‚ã›ã¦ã‚¿ãƒƒãƒ—</div>
      </div>
      <span class="game-status" id="status3">æœªã‚¯ãƒªã‚¢</span>
    </a>
    <a class="game-card" href="game4.html" data-game="4">
      <div class="game-icon">ğŸŒŒ</div>
      <div class="game-info">
        <div class="game-name">Game 4 - æ˜Ÿã®è¨˜æ†¶</div>
        <div class="game-desc">è¨˜æ†¶åŠ›ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚²ãƒ¼ãƒ </div>
      </div>
      <span class="game-status" id="status4">æœªã‚¯ãƒªã‚¢</span>
    </a>
    <a class="game-card" href="game5.html" data-game="5">
      <div class="game-icon">ğŸƒ</div>
      <div class="game-info">
        <div class="game-name">Game 5 - é¢¨ã®ç–¾èµ°</div>
        <div class="game-desc">ã‚¹ãƒ”ãƒ¼ãƒ‰ç³»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ </div>
      </div>
      <span class="game-status" id="status5">æœªã‚¯ãƒªã‚¢</span>
    </a>
    <a class="game-card" href="game6.html" data-game="6">
      <div class="game-icon">ğŸ”®</div>
      <div class="game-info">
        <div class="game-name">Game 6 - é­‚ã®æœ€çµ‚ç« </div>
        <div class="game-desc">ã™ã¹ã¦ã‚’çµ±ã¹ã‚‹æœ€å¾Œã®è©¦ç·´</div>
      </div>
      <span class="game-status" id="status6">æœªã‚¯ãƒªã‚¢</span>
    </a>
  </div>

  <button class="back-to-input-btn" onclick="goToInput()">ğŸ”® åˆè¨€è‘‰å…¥åŠ›ã¸</button>
</div>

<!-- ===== è±ªè¯ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ ===== -->
<div class="screen" id="endingScreen">
  <div class="ending-fireworks" id="endingFireworks"></div>
  <div class="confetti-container" id="confettiContainer"></div>

  <div class="ending-content">
    <div style="position:relative; display:inline-block; margin-bottom:5px;">
      <div class="sparkle-ring" style="position:absolute;top:50%;left:50%;"></div>
      <div class="sparkle-ring ring2" style="position:absolute;top:50%;left:50%;"></div>
      <div class="ending-crown">ğŸ‘‘</div>
    </div>

    <div class="ending-stars">
      <span class="ending-star">â­</span>
      <span class="ending-star">âœ¨</span>
      <span class="ending-star">â­</span>
      <span class="ending-star">âœ¨</span>
      <span class="ending-star">â­</span>
    </div>

    <div class="ending-title">CONGRATULATIONS</div>
    <div class="ending-subtitle">â€” ALL CLEAR â€”</div>

    <div class="ending-divider"></div>

    <div class="ending-message">
      ğŸŠ ã™ã¹ã¦ã®è©¦ç·´ã‚’ä¹—ã‚Šè¶ŠãˆãŸ ğŸŠ<br>
      ã‚ãªãŸã¯çœŸã®å‹‡è€…ã§ã™
    </div>

    <div class="ending-password-reveal">
      <div class="ending-char">ã</div>
      <div class="ending-char">ã†</div>
      <div class="ending-char">ã</div>
      <div class="ending-char">ãŒ</div>
      <div class="ending-char">ãª</div>
      <div class="ending-char">ã‚“</div>
    </div>

    <div class="ending-btn-container">
      <a class="ending-btn" href="https://youtu.be/Mj2tXt5ErGI?si=3Lu6kAwAIK1qe_hP" target="_blank" rel="noopener">
        ğŸ¬ ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã€‚
      </a>
    </div>

    <div class="ending-bottom-text">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ ãƒ¼ãƒ“ãƒ¼ã¸</div>

    <button class="restart-btn" onclick="restart()">ğŸ”„ æœ€åˆã‹ã‚‰</button>
  </div>
</div>

<script>
const TOTAL = 6;
const ANSWER = ['ã','ã†','ã','ãŒ','ãª','ã‚“'];
const HINT_CHARS = ['ã','ã†','ã','ãŒ','ãª','ã‚“'];

let currentIndex = 0;
let inputChars = Array(TOTAL).fill('');
let clearedGames = JSON.parse(localStorage.getItem('clearedGames') || '[]');

(function() {
  const c = document.getElementById('particles');
  const colors = ['#6c63ff','#4ecdc4','#ff6b9d','#ffd700','#00ceff','#b464ff'];
  for (let i = 0; i < 30; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const s = Math.random() * 4 + 2;
    p.style.width = s + 'px';
    p.style.height = s + 'px';
    p.style.left = Math.random() * 100 + '%';
    p.style.background = colors[Math.floor(Math.random() * colors.length)];
    p.style.animationDuration = (Math.random() * 8 + 6) + 's';
    p.style.animationDelay = (Math.random() * 10) + 's';
    c.appendChild(p);
  }
})();

function createEndingEffects() {
  // Fireworks
  const fw = document.getElementById('endingFireworks');
  fw.innerHTML = '';
  const fwColors = ['#ffd700','#ff6b9d','#6c63ff','#4ecdc4','#ff4500','#00ff88','#ff00ff','#00ceff'];
  for (let i = 0; i < 12; i++) {
    const f = document.createElement('div');
    f.className = 'firework';
    f.style.left = (10 + Math.random() * 80) + '%';
    f.style.top = (10 + Math.random() * 60) + '%';
    f.style.color = fwColors[Math.floor(Math.random() * fwColors.length)];
    f.style.animationDelay = (Math.random() * 3) + 's';
    f.style.animationDuration = (1.5 + Math.random() * 1.5) + 's';
    fw.appendChild(f);
  }

  // Confetti
  const cc = document.getElementById('confettiContainer');
  cc.innerHTML = '';
  const confettiColors = ['#ffd700','#ff6b9d','#6c63ff','#4ecdc4','#ff4500','#00ff88','#b464ff','#00ceff','#fff'];
  for (let i = 0; i < 50; i++) {
    const c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = Math.random() * 100 + '%';
    c.style.width = (6 + Math.random() * 8) + 'px';
    c.style.height = (8 + Math.random() * 10) + 'px';
    c.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
    c.style.animationDuration = (3 + Math.random() * 4) + 's';
    c.style.animationDelay = (Math.random() * 5) + 's';
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    cc.appendChild(c);
  }
}

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  if (id === 'endingScreen') {
    createEndingEffects();
  }
}

function showMessage(text, type) {
  const m = document.getElementById('message');
  m.textContent = text;
  m.className = 'message ' + type + ' show';
  setTimeout(() => m.classList.remove('show'), 2000);
}

function updateCharBoxes() {
  const boxes = document.querySelectorAll('.char-box');
  boxes.forEach((box, i) => {
    box.textContent = inputChars[i];
    box.classList.remove('active','filled','hint-revealed');
    if (i === currentIndex && currentIndex < TOTAL) box.classList.add('active');
    if (inputChars[i]) box.classList.add('filled');
    if (clearedGames.includes(i + 1)) box.classList.add('hint-revealed');
  });
}

function inputChar(char) {
  if (currentIndex >= TOTAL) return;
  inputChars[currentIndex] = char;
  currentIndex = Math.min(currentIndex + 1, TOTAL);
  updateCharBoxes();
}

function backspace() {
  if (currentIndex > 0) {
    currentIndex--;
    inputChars[currentIndex] = '';
    updateCharBoxes();
  }
}

function clearAll() {
  currentIndex = 0;
  inputChars = Array(TOTAL).fill('');
  updateCharBoxes();
}

function submit() {
  if (inputChars.some(c => c === '')) {
    showMessage('ï¼–æ–‡å­—ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
    document.getElementById('charBoxes').classList.add('shake');
    setTimeout(() => document.getElementById('charBoxes').classList.remove('shake'), 500);
    return;
  }
  if (inputChars.every((c, i) => c === ANSWER[i])) {
    showMessage('ğŸ‰ æ­£è§£ï¼ï¼ãŠã‚ã§ã¨ã†ï¼ï¼', 'success');
    setTimeout(() => showScreen('endingScreen'), 800);
  } else {
    showMessage('ä¸æ­£è§£â€¦ ã‚²ãƒ¼ãƒ ã§ãƒ’ãƒ³ãƒˆã‚’é›†ã‚ã‚ˆã†', 'error');
    document.getElementById('charBoxes').classList.add('shake');
    setTimeout(() => {
      document.getElementById('charBoxes').classList.remove('shake');
      clearAll();
      goToMenu();
    }, 1000);
  }
}

document.getElementById('keyboard').addEventListener('click', (e) => {
  const key = e.target.closest('.key');
  if (!key) return;
  if (key.dataset.char) inputChar(key.dataset.char);
  else if (key.dataset.action === 'backspace') backspace();
  else if (key.dataset.action === 'clear') clearAll();
  else if (key.dataset.action === 'submit') submit();
});

document.getElementById('charBoxes').addEventListener('click', (e) => {
  const box = e.target.closest('.char-box');
  if (!box) return;
  currentIndex = parseInt(box.dataset.index);
  updateCharBoxes();
});

function getNextGame() {
  for (let i = 1; i <= TOTAL; i++) {
    if (!clearedGames.includes(i)) return i;
  }
  return null;
}

function goToMenu() {
  updateMenu();
  showScreen('menuScreen');
}

function goToInput() {
  inputChars = Array(TOTAL).fill('');
  clearedGames.forEach(gNum => {
    const idx = gNum - 1;
    if (idx >= 0 && idx < TOTAL) inputChars[idx] = HINT_CHARS[idx];
  });
  currentIndex = inputChars.findIndex(c => c === '');
  if (currentIndex === -1) currentIndex = TOTAL;
  updateCharBoxes();
  showScreen('inputScreen');
}

function updateMenu() {
  const nextGame = getNextGame();
  document.querySelectorAll('.hint-char').forEach((el, i) => {
    if (clearedGames.includes(i + 1)) {
      el.textContent = HINT_CHARS[i];
      el.classList.add('revealed');
    } else {
      el.textContent = 'ï¼Ÿ';
      el.classList.remove('revealed');
    }
  });
  document.querySelectorAll('.game-card').forEach(card => {
    const gNum = parseInt(card.dataset.game);
    const status = document.getElementById('status' + gNum);
    card.classList.remove('locked','current-game');
    if (clearedGames.includes(gNum)) {
      status.textContent = 'ã‚¯ãƒªã‚¢æ¸ˆ âœ“';
      status.className = 'game-status cleared';
    } else if (gNum === nextGame) {
      card.classList.add('current-game');
      status.textContent = 'æŒ‘æˆ¦å¯èƒ½';
      status.className = 'game-status not-cleared';
    } else {
      card.classList.add('locked');
      status.textContent = 'ğŸ”’ ãƒ­ãƒƒã‚¯';
      status.className = 'game-status locked-status';
    }
  });
}

function checkGameClears() {
  for (let i = 1; i <= TOTAL; i++) {
    if (localStorage.getItem('gameClear_' + i) === 'true') {
      if (!clearedGames.includes(i)) clearedGames.push(i);
    }
  }
  clearedGames.sort((a, b) => a - b);
  localStorage.setItem('clearedGames', JSON.stringify(clearedGames));
}

function restart() {
  localStorage.clear();
  clearedGames = [];
  clearAll();
  showScreen('inputScreen');
}

(function init() {
  checkGameClears();
  const params = new URLSearchParams(window.location.search);
  if (params.get('menu') === '1') {
    goToMenu();
  } else if (clearedGames.length > 0) {
    goToInput();
  } else {
    updateCharBoxes();
  }
})();
</script>

</body>
</html>